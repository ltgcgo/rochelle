"use strict";let y={"866":"cp866","utf-8":"utf-8",utf8:"utf-8","utf-16":"utf-16",utf16:"utf-16","utf-16le":"utf-16",utf16le:"utf-16",unicode:"utf-16",unicodefeff:"utf-16","ucs-2":"utf-16","utf-16be":"utf-16be",utf16be:"utf-16be","utf-24":"utf-24",utf24:"utf-24","utf-24le":"utf-24",utf24le:"utf-24","utf-24be":"utf-24be",utf24be:"utf-24be","utf-32":"utf-32",utf32:"utf-32","utf-32le":"utf-32",utf32le:"utf-32","utf-32be":"utf-32be",utf32be:"utf-32be",latin1:"latin1",l1:"latin1",ascii:"latin1","us-ascii":"latin1","iso-8859-1":"latin1","iso8859-1":"latin1",cp1252:"latin1","windows-1252":"latin1",cp819:"latin1",ibm819:"latin1",latin2:"latin2",l2:"latin2","iso-8859-2":"latin2","iso8859-2":"latin2",latin3:"latin3",l3:"latin3","iso-8859-3":"latin3","iso8859-3":"latin3",latin4:"latin4",l4:"latin4","iso-8859-4":"latin4","iso8859-4":"latin4",latin5:"latin5",l5:"latin5","iso-8859-9":"latin5","iso8859-9":"latin5",cp1254:"latin5","windows-1254":"latin5",latin6:"latin6",l6:"latin6","iso-8859-10":"latin6","iso8859-10":"latin6",latin9:"latin9",l9:"latin9","iso-8859-15":"latin9","iso8859-15":"latin9","iso-8859-5":"iso-8859-5","iso8859-5":"iso-8859-5",cyrillic:"iso-8859-5","iso-8859-6":"iso-8859-6","iso8859-6":"iso-8859-6","iso-8859-6-e":"iso-8859-6","iso8859-6e":"iso-8859-6","iso-8859-6-i":"iso-8859-6","iso8859-6i":"iso-8859-6","asmo-708":"iso-8859-6","ecma-114":"iso-8859-6",arabic:"iso-8859-6","iso-8859-7":"iso-8859-7","iso8859-7":"iso-8859-7","ecma-118":"iso-8859-7",greek:"iso-8859-7",greek8:"iso-8859-7","iso-8859-8":"iso-8859-8","iso8859-8":"iso-8859-8","iso-8859-8-e":"iso-8859-8","iso8859-8e":"iso-8859-8",hebrew:"iso-8859-8",visual:"iso-8859-8","iso-8859-8-i":"iso-8859-8-i","iso8859-8i":"iso-8859-8-i",logical:"iso-8859-8-i","iso-8859-11":"iso-8859-11","iso8859-11":"iso-8859-11","windows-874":"iso-8859-11","dos-874":"iso-8859-11",cp874:"iso-8859-11","tis-620":"iso-8859-11","iso-8859-13":"iso-8859-13","iso8859-13":"iso-8859-13",latin7:"iso-8859-13",l7:"iso-8859-13","iso-8859-14":"iso-8859-14","iso8859-14":"iso-8859-14",latin8:"iso-8859-14",l8:"iso-8859-14","iso-8859-16":"iso-8859-16","iso8859-16":"iso-8859-16",cp866:"cp866",ibm866:"cp866",cp1250:"cp1250","windows-1250":"cp1250",cp1251:"cp1251","windows-1251":"cp1251",cp1253:"cp1253","windows-1253":"cp1253",cp1255:"cp1255","windows-1255":"cp1255",cp1256:"cp1256","windows-1256":"cp1256",cp1257:"cp1257","windows-1257":"cp1257",cp1258:"cp1258","windows-1258":"cp1258","euc-jp":"euc-jp",cp954:"euc-jp","euc-kr":"euc-kr",koi8:"koi8",koi:"koi8","koi8-r":"koi8","koi8-u":"koi8-u","koi8-ru":"koi8-u",mac:"mac",macintosh:"mac","mac-cyrillic":"x-mac-cyrillic","x-mac-cyrillic":"x-mac-cyrillic","x-mac-ukrainian":"x-mac-cyrillic",gbk:"gbk",gb2312:"gbk",chinese:"gbk","euc-cn":"gbk",gb18030:"gb18030",big5:"big5","big5-hkscs":"big5",sjis:"sjis","shift-jis":"sjis",ms932:"sjis","windows-31j":"sjis"};let E={"utf-8":1,"utf-16":2,"utf-16be":3,"utf-24":4,"utf-24be":5,"utf-32":6,"utf-32be":7,latin1:0,latin2:0,latin3:0,latin4:0,latin5:0,latin6:0,latin9:0,"iso-8859-5":0,"iso-8859-6":0,"iso-8859-7":0,"iso-8859-8":0,"iso-8859-8-i":0,"iso-8859-11":0,"iso-8859-13":0,"iso-8859-14":0,"iso-8859-16":0,cp866:0,cp1250:0,cp1251:0,cp1253:0,cp1255:0,cp1256:0,cp1257:0,cp1258:0,"euc-jp":1,"euc-kr":1,koi8:0,"koi8-u":0,mac:0,"x-mac-cyrillic":0,gbk:1,gb18030:1,big5:1,sjis:1};let p=class{static BYTE_1=0;static BYTE_1_VL=1;static BYTE_2_LE=2;static BYTE_2_BE=3;static BYTE_3_LE=4;static BYTE_3_BE=5;static BYTE_4_LE=6;static BYTE_4_BE=7;static getUnitSize(i){if(i>7)throw new RangeError("Cannot decode encodings with more than 4 bits per unit.");return(i>>1)+1}static isBigEndian(i){return(i&1)===1}static collapse(i){let e=y[i];if(typeof e!="string")throw new TypeError(`Provided label "${i}" is not supported.`);return e}static indicator(i){let e=E[i];if(typeof e!="number")throw new TypeError(`Provided collapsed label "${i}" is not supported.`);return e}};let m=(c,i)=>{c.unsent=!1,c.enqueue(i)},T=class{static lineRaw(c,i=0){if(typeof i!="number"||i<0||i>7)throw new TypeError("Invalid split mode.");if(!c||c?.constructor!==ReadableStream)throw new TypeError("Not a readable stream.");let e=p.getUnitSize(i),g=p.isBigEndian(i),w=c.getReader(),s,b=!1,t=[],a=0,u=0,h=0;return new ReadableStream({pull:async d=>{for(d.unsent=!0;d.unsent;){if(!s||a>=s.length){a>u&&(t.push(s.subarray(u)),u=0);let{value:l,done:r}=await w.read();s=l,b=r,a=0}if(s){let l=0;if(e===1)l=s[a];else if(g)for(let o=0;o<e;o++)l<<=8,l|=s[a+o];else for(let o=0;o<e;o++)l|=s[a+o]<<(o<<3);let r=!1;switch(l){case 10:{h===13?u+=e:r=!0;break}case 13:{r=!0;break}}if(r){if(t.length){t.push(s.subarray(u,a));let o=0;for(let f=0;f<t.length;f++)o+=t[f].length;let n=new Uint8Array(o),k=0;for(let f=0;f<t.length;f++)n.set(t[f],k),k+=t[f].length;m(d,n),t=[]}else m(d,s.subarray(u,a));u=a+=e}h=l}if(b){if(u!==a&&s&&t.push(s.subarray(u,a)),t.length){let l=0;for(let n=0;n<t.length;n++)l+=t[n].length;let r=new Uint8Array(l),o=0;for(let n=0;n<t.length;n++)r.set(t[n],o),o+=t[n].length;m(d,r)}d.unsent=!1,d.close()}a+=e}}},new ByteLengthQueuingStrategy({highWaterMark:256}))}static line(c,i="utf-8"){let e=p.collapse(i),g=p.indicator(e),w=this.lineRaw(c,g).getReader(),s=new TextDecoder(e);return new ReadableStream({pull:async b=>{let{value:t,done:a}=await w.read();t&&b.enqueue(s.decode(t)),a&&b.close()}})}},P=T;export{P as default};
